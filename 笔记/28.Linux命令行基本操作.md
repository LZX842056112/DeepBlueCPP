### **Linux 命令行基本操作学习**

------



**步骤一：你的第一个脚本 "Hello, World!"**

这是所有编程语言学习的起点。它简单，但包含了执行一个程序所需的所有基本要素。

1. **创建脚本文件**：打开你的Linux终端，输入以下命令：

   ```bash
   touch hello_world.sh
   ```

   `touch` 命令会创建一个名为 `hello_world.sh` 的空文件。`.sh` 是Shell脚本的惯用扩展名。

2. **编写脚本内容**：

   ```bash
   nano hello_world.sh
   ```

   在编辑器中，输入以下两行内容：

   ```bash
   #!/bin/bash
   echo "Hello, fellow students!"
   ```

   - `#!/bin/bash`：这被称为**Shebang**。它必须位于脚本的第一行。`#!` 是一个特殊的标记，它告诉操作系统，当执行这个文件时，应该使用 `/bin/bash` 这个程序（也就是Bash解释器）来处理文件中的内容。
   - `echo`：这是一个基本命令，用于在终端上打印（输出）紧跟其后的文本。

3. **赋予执行权限**：在Linux中，文件默认是没有执行权限的。你需要明确地授予它：

   ```bash
   chmod +x hello_world.sh
   ```

   `chmod` (change mode) 是修改文件权限的命令。`+x` 表示为该文件添加（`+`）执行（`x`）权限。

4. **执行脚本**：现在，运行你的第一个程序！

   ```bash
   ./hello_world.sh
   ```

   - `./` 表示“当前目录”。这告诉Shell在当前目录下查找并执行 `hello_world.sh`。
   - **输出**: `Hello, fellow students!`

你已经成功地创建并执行了一个Bash脚本！

**步骤二：使用变量 (Variables) 和用户输入 (User Input)**

静态的脚本很有用，但能与用户交互的脚本则更加强大。

1. **变量**：在Bash中，你可以定义变量来存储数据。

   ```bash
   #!/bin/bash
   
   # 变量赋值 (注意：等号两边不能有空格)
   GREETING="Welcome to the world of Bash!"
   
   # 使用变量 (在变量名前加上$)
   echo $GREETING
   ```

   保存并执行，你会看到变量中存储的句子被打印出来。

2. **读取用户输入**：我们可以使用 `read` 命令来获取用户在键盘上的输入，并将其存入一个变量。

   ```bash
   #!/bin/bash
   
   echo "What is your name?"
   read USER_NAME
   echo "Hello, $USER_NAME! Nice to meet you."
   ```

   执行这个脚本，它会先提问，等待你输入名字并按回车，然后用你的名字向你问好。

**步骤三：控制流 (Control Flow)——让脚本变得智能**

控制流允许你的脚本根据不同的条件执行不同的代码路径。

1. if-else 条件判断：

   让我们写一个脚本，判断一个数字是否大于10。

   ```bash
   #!/bin/bash
   
   echo "Enter a number:"
   read NUM
   
   # if [ condition ]; then ... fi 是基本结构
   # 注意：'[' 和 ']' 与其中的条件之间必须有空格！
   if [ $NUM -gt 10 ]; then
     echo "The number $NUM is greater than 10."
   elif [ $NUM -eq 10 ]; then
     echo "The number $NUM is exactly 10."
   else
     echo "The number $NUM is not greater than 10."
   fi
   ```

   - `[ $NUM -gt 10 ]` 是一个条件测试。`-gt` 表示 "greater than"（大于）。其他常用的数字比较符有：`-lt` (less than), `-eq` (equal to), `-ne` (not equal to), `-ge` (greater or equal), `-le` (less or equal)。
   - `elif` 是 "else if" 的缩写。`fi` 是 `if` 的倒写，表示条件语句块的结束。

2. for 循环：

   for 循环允许你对一个列表中的每个元素重复执行一段代码。

   ```bash
   #!/bin/bash
   
   # 遍历一个数字列表
   echo "Counting to 5:"
   for i in 1 2 3 4 5; do
     echo $i
   done
   
   # 更有用的例子：遍历当前目录下的所有.txt文件
   echo -e "\nListing all .txt files:"
   for FILE in *.txt; do
     echo "Found a text file: $FILE"
   done
   ```

   - `*.txt` 是一种称为“通配符(globbing)”的模式，它会匹配所有以 `.txt` 结尾的文件名。
   - `do` 和 `done` 标记了循环体的开始和结束。

**步骤四：一个简单的“现实世界”脚本——自动备份文件**

现在，我们将以上所有概念结合起来，创建一个非常实用的脚本：备份一个指定的文件。

这个脚本将接收一个文件名作为参数，然后将该文件复制到一个 `backup` 目录中，并附加上当前的时间戳。

```bash
#!/bin/bash

# $1 是脚本的第一个命令行参数
FILE_TO_BACKUP=$1
BACKUP_DIR="backup"

# 检查用户是否提供了文件名
# -z "$VAR" 用来检查变量是否为空
if [ -z "$FILE_TO_BACKUP" ]; then
  echo "Error: Please provide a file to backup."
  echo "Usage: $0 <filename>"
  exit 1 # 以错误码退出
fi

# 检查文件是否存在
if [ ! -f "$FILE_TO_BACKUP" ]; then
  echo "Error: File '$FILE_TO_BACKUP' not found."
  exit 1
fi

# 创建备份目录 (如果它不存在的话)
# -p 选项确保如果目录已存在，命令不会报错
mkdir -p $BACKUP_DIR

# 生成时间戳
TIMESTAMP=$(date +%Y-%m-%d_%H-%M-%S)

# 执行复制操作
cp "$FILE_TO_BACKUP" "$BACKUP_DIR/${FILE_TO_BACKUP}_${TIMESTAMP}"

echo "Backup of '$FILE_TO_BACKUP' created successfully!"
```

**如何使用这个脚本？**

1. 保存为 `backup.sh` 并用 `chmod +x backup.sh` 赋予权限。
2. 创建一个测试文件: `echo "This is a test." > my_important_file.txt`。
3. 执行备份: `./backup.sh my_important_file.txt`。
4. 检查结果: `ls backup/`。你会看到一个带有时间戳的备份文件。

