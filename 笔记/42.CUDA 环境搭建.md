# CUDA 环境搭建



适用范围
- 系统：Windows 10/11 64 位
- GPU：NVIDIA 独显
- 权限：管理员权限
- 磁盘空间：至少 5~10 GB

开始前的快速自检
- 确认电脑里有 NVIDIA 独显（设备管理器 → 显卡）
- 准备好稳定网络和管理员权限
- 如已安装旧版 CUDA，建议先卸载，避免环境变量冲突

A. 原生 Windows 安装步骤
1) 安装 Visual Studio（C++ 工作负载）
- 安装 VS 2022，VS 2022 + CUDA 13 通常没问题。
- 勾选工作负载：
  - “使用 C++ 的桌面开发”
  - 组件建议：MSVC v143（VS 2022），C++ CMake 工具
- 安装完成后可重启一次

2) 安装/更新 NVIDIA 显卡驱动
- 前往 NVIDIA 官网安装最新 Studio Driver（开发更稳定），或使用 GeForce Experience 更新
- 安装完成后，打开命令行验证：
  - Win + R → cmd，执行：
    nvidia-smi
  - 正常会显示驱动版本和 GPU 信息

3) 安装 CUDA Toolkit
- 前往 NVIDIA CUDA 下载页，选择：
  - Operating System: Windows
  - Architecture: x86_64
  - Version: 对应你的 Windows 10/11
  - Installer Type: exe (local) 更稳
- 安装完成重启

4) 验证 CUDA 环境变量与编译器
- 打开新的命令行（PowerShell 或 cmd），执行：
  nvcc -V
  echo %CUDA_PATH%
  echo %PATH%
- 预期：
  - nvcc -V 显示 CUDA 版本（如 release 12.x）
  - CUDA_PATH 指向 C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v12.x
  - PATH 中包含 ...\CUDA\v12.x\bin
  

5） 用 nvcc 编译一份最小示例

- 新建文件 hello.cu，内容如下：
  #include <cstdio>
  __global__ void helloFromGPU() {
      printf("Hello from GPU\n");
  }
  int main() {
      printf("Hello from CPU\n");
      helloFromGPU<<<1,1>>>();
      cudaDeviceSynchronize();
      return 0;
  }
- 在包含 nvcc 的命令行中编译并运行：
  nvcc hello.cu -o hello.exe
  hello.exe
- 预期输出：
  Hello from CPU
  Hello from GPU

D. 常见问题与排错速查
- nvcc 不是内部或外部命令
  - 关闭重新打开终端；检查 PATH 是否包含 CUDA\v12.x\bin
  - 检查 CUDA_PATH 是否指向正确版本
- Visual Studio 中没有 CUDA Build Customizations
  - 重新运行 CUDA 安装包，确保勾选 Visual Studio Integration
  - 以管理员身份安装
- nvcc fatal: Host compiler targets unsupported release
  - CUDA 与 VS 工具链版本不兼容。方案：升级/降级 VS 或安装与当前 VS 匹配的 CUDA 版本
- “no CUDA-capable device is detected”
  - 驱动未正确安装/过旧、GPU 被禁用、远程桌面环境限制、笔记本未使用独显
  - 在 NVIDIA 控制面板 → 管理 3D 设置 → 首选图形处理器：高性能 NVIDIA 处理器
- 链接错误 unresolved externals（cudaRuntime 等）
  - .cu 未被当作 CUDA 编译；确保勾选 Build Customizations、并将 .cu 的 Item Type 设为 CUDA C/C++
- 多版本 CUDA 并存冲突
  - 使用特定版本 nvcc 的绝对路径编译，或确保 CUDA_PATH 指向目标版本
- Samples 编译报错
  - 用与安装包一致的 VS 版本/平台（x64/Release），或直接运行已编译 demo 先做验证

